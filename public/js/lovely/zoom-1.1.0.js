/**
 * lovely.io 'zoom' module v1.1.0
 *
 * Copyright (C) 2012 Nikolay Nemshilov
 */
Lovely("zoom-1.1.0",["ui-2.0.0"],function(a){var b={},c,Class,d,e,f,g,h,i,Zoom,j,k,b,l;return j=this.Lovely.module("core"),i=this.Lovely.module("ui-2.0.0"),c=Lovely.module("dom"),l=j.ext,Class=j.Class,h=j.Options,d=c.Element,f=i.Locker,g=i.Modal,e=i.Icon,Zoom=new Class(g,{include:h,extend:{Options:{nolock:!1,fxDuration:"normal"},current:null},constructor:function Zoom(a){var b=this;return this.$super(a).addClass("lui-zoom"),this.locker=new f,this.icon=new e("remove"),this.image=new d("img"),this.dialog.append(this.image,this.icon),this.icon.on("click",function(){return b.hide()}),d.prototype.insert.call(this,this.locker)},show:function(a){var b=this;return this.setOptions(a.data("zoom")).addClass("lui-modal-nolock").addClass("lui-zoom-loading"),this.dialog.style("display: none"),this.$super(),(this.thumb=a.first("img"))&&this.locker.show().position(this.thumb.position()).size(this.thumb.size()),this.image=this.image.clone().insertTo(this.image,"instead").attr("src",null),this.image.on("load",function(){return b.loaded()}).attr("src",a.attr("href")),this},loaded:function(){return this.removeClass("lui-zoom-loading").emit("load"),this.dialog.style("display: inline-block; opacity: 0"),this[this.options.nolock===!0?"addClass":"removeClass"]("lui-modal-nolock"),this.thumb&&this.options.fxDuration?this.zoom():(this.dialog.style({opacity:1}),this.emit("zoom")),this.locker.hide()},zoom:function(){var a,b,c,d,e,f=this;return d=this.thumb.position(),e=this.thumb.size(),b=this.dialog.size(),a=this.dialog.position(),this.dialog.addClass("lui-zoom-resizing").size(e).position(d),c=this.dialog.style("top,left"),c={x:parseInt(c.left),y:parseInt(c.top)},this.dialog.style({opacity:1}).animate({top:c.y+(a.y-d.y)+"px",left:c.x+(a.x-d.x)+"px",width:b.x+"px",height:b.y+"px"},{duration:this.options.fxDuration,finish:function(){return f.dialog.removeClass("lui-zoom-resizing").style({top:"",left:"",width:"",height:""}),f.emit("zoom")}})}}),Zoom.prototype.limit_size=function(a){return this.image._.style.maxWidth=this.dialog._.style.maxWidth=a.x-20+"px",this.image._.style.maxHeight=this.dialog._.style.maxHeight=a.y-5+"px",this},k=null,c(document).on({click:function(a){var b;if(b=a.find("a[data-zoom]"))return a.stop(),k||(k=new Zoom),k.show(b)}}),b=l(Zoom,{version:"1.1.0"}),b}),function(){var a=document.createElement("style"),b=document.createTextNode("div.lui-zoom.lui-zoom-loading{position:absolute}div.lui-zoom>div.lui-locker{z-index:1;overflow:hidden;display:none}div.lui-zoom>div.lui-inner{z-index:2;overflow:inherit}div.lui-zoom>div.lui-inner>i{display:inline-block;position:absolute;top:-0.9em;right:-0.9em;font-weight:normal;width:1.5em;height:1.5em;line-height:1.57em;border:2px solid rgba(0,0,0,0.2);border-radius:1em;color:rgba(0,0,0,0.2);background-color:rgba(255,255,255,0.5);cursor:pointer}div.lui-zoom>div.lui-inner>i:hover{border-color:rgba(0,0,0,0.5);color:rgba(0,0,0,0.5);background-color:rgba(255,255,255,0.8)}div.lui-zoom>div.lui-inner>img{margin:0;padding:0;display:block;box-shadow:0 0.2em 0.75em rgba(0,0,0,0.5);border-radius:0.3em}div.lui-zoom>div.lui-inner.lui-zoom-resizing{position:absolute}div.lui-zoom>div.lui-inner.lui-zoom-resizing>img{width:100%;height:100%}");a.type="text/css",document.getElementsByTagName("head")[0].appendChild(a),a.styleSheet?a.styleSheet.cssText=b.nodeValue:a.appendChild(b)}()